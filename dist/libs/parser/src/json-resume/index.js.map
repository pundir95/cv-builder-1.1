{"version":3,"sources":["../../../../../libs/parser/src/json-resume/index.ts"],"sourcesContent":["import { createId } from \"@paralleldrive/cuid2\";\r\nimport {\r\n  defaultAward,\r\n  defaultCertification,\r\n  defaultEducation,\r\n  defaultExperience,\r\n  defaultInterest,\r\n  defaultLanguage,\r\n  defaultProfile,\r\n  defaultPublication,\r\n  defaultReference,\r\n  defaultResumeData,\r\n  defaultSkill,\r\n  defaultVolunteer,\r\n} from \"@reactive-resume/schema\";\r\nimport type { Json } from \"@reactive-resume/utils\";\r\nimport type { Schema } from \"zod\";\r\n\r\nimport type { Parser } from \"../interfaces/parser\";\r\nimport type { JsonResume } from \"./schema\";\r\nimport { jsonResumeSchema } from \"./schema\";\r\n\r\nexport * from \"./schema\";\r\n\r\nexport class JsonResumeParser implements Parser<Json, JsonResume> {\r\n  schema: Schema;\r\n\r\n  constructor() {\r\n    this.schema = jsonResumeSchema;\r\n  }\r\n\r\n  readFile(file: File): Promise<Json> {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n\r\n      // eslint-disable-next-line unicorn/prefer-add-event-listener\r\n      reader.onload = () => {\r\n        try {\r\n          const result = JSON.parse(reader.result as string) as Json;\r\n          resolve(result);\r\n        } catch {\r\n          reject(new Error(\"Failed to parse JSON\"));\r\n        }\r\n      };\r\n\r\n      // eslint-disable-next-line unicorn/prefer-add-event-listener\r\n      reader.onerror = () => {\r\n        reject(new Error(\"Failed to read the file\"));\r\n      };\r\n\r\n      // eslint-disable-next-line unicorn/prefer-blob-reading-methods\r\n      reader.readAsText(file);\r\n    });\r\n  }\r\n\r\n  validate(data: Json) {\r\n    return this.schema.parse(data) as JsonResume;\r\n  }\r\n\r\n  convert(data: JsonResume) {\r\n    const result = JSON.parse(JSON.stringify(defaultResumeData));\r\n\r\n    // Basics\r\n    result.basics.name = data.basics?.name ?? \"\";\r\n    result.basics.headline = data.basics?.label ?? \"\";\r\n    result.basics.picture.url = data.basics?.image ?? \"\";\r\n    result.basics.email = data.basics?.email ?? \"\";\r\n    result.basics.phone = data.basics?.phone ?? \"\";\r\n    result.basics.location = data.basics?.location?.address ?? \"\";\r\n    result.basics.url.href = data.basics?.url ?? \"\";\r\n    result.sections.summary.content = data.basics?.summary ?? \"\";\r\n\r\n    // Profiles\r\n    if (data.basics?.profiles) {\r\n      for (const profile of data.basics.profiles) {\r\n        result.sections.profiles.items.push({\r\n          ...defaultProfile,\r\n          id: createId(),\r\n          icon: profile.network?.toLocaleLowerCase() ?? \"\",\r\n          network: profile.network ?? \"\",\r\n          username: profile.username ?? \"\",\r\n          url: { ...defaultProfile.url, href: profile.url ?? \"\" },\r\n        });\r\n      }\r\n    }\r\n\r\n    // Work\r\n    if (data.work) {\r\n      for (const work of data.work) {\r\n        result.sections.experience.items.push({\r\n          ...defaultExperience,\r\n          id: createId(),\r\n          company: work.name ?? \"\",\r\n          position: work.position ?? \"\",\r\n          summary: work.summary ?? \"\",\r\n          date: `${work.startDate} - ${work.endDate}`,\r\n          url: { ...defaultExperience.url, href: work.url ?? \"\" },\r\n        });\r\n      }\r\n    }\r\n\r\n    // Volunteer\r\n    if (data.volunteer) {\r\n      for (const volunteer of data.volunteer) {\r\n        result.sections.volunteer.items.push({\r\n          ...defaultVolunteer,\r\n          id: createId(),\r\n          organization: volunteer.organization ?? \"\",\r\n          date: `${volunteer.startDate} - ${volunteer.endDate}`,\r\n          position: volunteer.position ?? \"\",\r\n          summary: volunteer.summary ?? \"\",\r\n          url: { ...defaultVolunteer.url, href: volunteer.url ?? \"\" },\r\n        });\r\n      }\r\n    }\r\n\r\n    // Education\r\n    if (data.education) {\r\n      for (const education of data.education) {\r\n        result.sections.education.items.push({\r\n          ...defaultEducation,\r\n          id: createId(),\r\n          institution: education.institution ?? \"\",\r\n          studyType: education.studyType ?? \"\",\r\n          area: education.area ?? \"\",\r\n          score: education.score ?? \"\",\r\n          date: `${education.startDate} - ${education.endDate}`,\r\n          url: { ...defaultEducation.url, href: education.url ?? \"\" },\r\n        });\r\n      }\r\n    }\r\n\r\n    // Awards\r\n    if (data.awards) {\r\n      for (const award of data.awards) {\r\n        result.sections.awards.items.push({\r\n          ...defaultAward,\r\n          id: createId(),\r\n          title: award.title ?? \"\",\r\n          date: award.date ?? \"\",\r\n          awarder: award.awarder ?? \"\",\r\n          summary: award.summary ?? \"\",\r\n        });\r\n      }\r\n    }\r\n\r\n    // Certificates\r\n    if (data.certificates) {\r\n      for (const certificate of data.certificates) {\r\n        result.sections.certifications.items.push({\r\n          ...defaultCertification,\r\n          id: createId(),\r\n          name: certificate.name ?? \"\",\r\n          date: certificate.date ?? \"\",\r\n          issuer: certificate.issuer ?? \"\",\r\n          summary: certificate.summary ?? \"\",\r\n        });\r\n      }\r\n    }\r\n\r\n    // Publications\r\n    if (data.publications) {\r\n      for (const publication of data.publications) {\r\n        result.sections.publications.items.push({\r\n          ...defaultPublication,\r\n          id: createId(),\r\n          name: publication.name ?? \"\",\r\n          publisher: publication.publisher ?? \"\",\r\n          summary: publication.summary ?? \"\",\r\n          date: publication.releaseDate ?? \"\",\r\n          url: { ...defaultPublication.url, href: publication.url ?? \"\" },\r\n        });\r\n      }\r\n    }\r\n\r\n    // Skills\r\n    if (data.skills) {\r\n      for (const skill of data.skills) {\r\n        result.sections.skills.items.push({\r\n          ...defaultSkill,\r\n          id: createId(),\r\n          name: skill.name ?? \"\",\r\n          description: skill.level ?? \"\",\r\n          keywords: skill.keywords ?? [],\r\n        });\r\n      }\r\n    }\r\n\r\n    // Languages\r\n    if (data.languages) {\r\n      for (const language of data.languages) {\r\n        result.sections.languages.items.push({\r\n          ...defaultLanguage,\r\n          id: createId(),\r\n          name: language.language ?? \"\",\r\n          description: language.fluency ?? \"\",\r\n        });\r\n      }\r\n    }\r\n\r\n    // Interests\r\n    if (data.interests) {\r\n      for (const interest of data.interests) {\r\n        result.sections.interests.items.push({\r\n          ...defaultInterest,\r\n          id: createId(),\r\n          name: interest.name ?? \"\",\r\n          keywords: interest.keywords ?? [],\r\n        });\r\n      }\r\n    }\r\n\r\n    // References\r\n    if (data.references) {\r\n      for (const reference of data.references) {\r\n        result.sections.references.items.push({\r\n          ...defaultReference,\r\n          id: createId(),\r\n          name: reference.name ?? \"\",\r\n          summary: reference.reference ?? \"\",\r\n        });\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n}\r\n"],"names":["JsonResumeParser","readFile","file","Promise","resolve","reject","reader","FileReader","onload","result","JSON","parse","Error","onerror","readAsText","validate","data","schema","convert","stringify","defaultResumeData","basics","name","headline","label","picture","url","image","email","phone","location","address","href","sections","summary","content","profiles","profile","items","push","defaultProfile","id","createId","icon","network","toLocaleLowerCase","username","work","experience","defaultExperience","company","position","date","startDate","endDate","volunteer","defaultVolunteer","organization","education","defaultEducation","institution","studyType","area","score","awards","award","defaultAward","title","awarder","certificates","certificate","certifications","defaultCertification","issuer","publications","publication","defaultPublication","publisher","releaseDate","skills","skill","defaultSkill","description","level","keywords","languages","language","defaultLanguage","fluency","interests","interest","defaultInterest","references","reference","defaultReference","constructor","jsonResumeSchema"],"mappings":"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"}